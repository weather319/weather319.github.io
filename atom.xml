<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>All IS ONE</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://weather319.github.io/"/>
  <updated>2016-04-29T09:13:43.000Z</updated>
  <id>http://weather319.github.io/</id>
  
  <author>
    <name>Weather</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python 操作numpy 矩阵代替for循环</title>
    <link href="http://weather319.github.io/2016/04/29/Python-%E6%93%8D%E4%BD%9Cnumpy-%E7%9F%A9%E9%98%B5%E4%BB%A3%E6%9B%BFfor%E5%BE%AA%E7%8E%AF/"/>
    <id>http://weather319.github.io/2016/04/29/Python-操作numpy-矩阵代替for循环/</id>
    <published>2016-04-29T07:56:38.000Z</published>
    <updated>2016-04-29T09:13:43.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;Python-操作numpy-矩阵代替for循环&quot;&gt;&lt;a href=&quot;#Python-操作numpy-矩阵代替for循环&quot; class=&quot;headerlink&quot; title=&quot;Python 操作numpy 矩阵代替for循环&quot;&gt;&lt;/a&gt;Python 操作numpy 矩阵代替for循环&lt;/h1&gt;&lt;h2 id=&quot;具体问题：&quot;&gt;&lt;a href=&quot;#具体问题：&quot; class=&quot;headerlink&quot; title=&quot;具体问题：&quot;&gt;&lt;/a&gt;具体问题：&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;上一篇文章中，使用kmeans聚类后，我得到了一个存放4个中心点颜色值的4 &lt;em&gt; 3矩阵。为了得到这个矩阵中，颜色残差最大的那个分类的索引，我必须使第三列减去（第一+第二列）的均值。最后找出色差最大的值，并返回索引。&lt;br&gt;** 4 &lt;/em&gt; 3矩阵中，使用for循环好像没什么问题，但是如果这个矩阵是1000乘以1000呢？那么循环次数达到了惊人的10^6次。**&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;方法：&quot;&gt;&lt;a href=&quot;#方法：&quot; class=&quot;headerlink&quot; title=&quot;方法：&quot;&gt;&lt;/a&gt;方法：&lt;/h2&gt;&lt;p&gt; 一开始为了快速得到结果，我使用了这样一个代码：C++的思路是使用for循环&lt;br&gt; &lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;find_max&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(center)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	print(&lt;span class=&quot;string&quot;&gt;&quot;中心点坐标为&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	m,n = np.shape(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	center_zero = np.float32(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	red_max = (center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; red_max&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	idmax = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;comment&quot;&gt;#循环次数为行数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		print(center_zero[i][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (center_zero[i][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;) &amp;gt; red_max:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			 red_max = (center_zero[i][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			 idmax = i&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	zero = np.zeros([m,n])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	zero[idmax] = center[idmax]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 	print(&lt;span class=&quot;string&quot;&gt;&quot;选取第[&amp;#123;&amp;#125;]类&quot;&lt;/span&gt;.format(idmax + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(&lt;span class=&quot;string&quot;&gt;&quot;坐标值为&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(zero)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;运行结果：&quot;&gt;&lt;a href=&quot;#运行结果：&quot; class=&quot;headerlink&quot; title=&quot;运行结果：&quot;&gt;&lt;/a&gt;运行结果：&lt;/h2&gt; &lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cen = np.float32(np.array([[&lt;span class=&quot;number&quot;&gt;137&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;81&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;127&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;]]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;find_max(cen)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;中心点坐标为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;	[[&lt;span class=&quot;number&quot;&gt;137&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [ &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [ &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;81&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;127&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-6.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;2.5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;40.5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&quot;number&quot;&gt;-2.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;选取第[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]类为鱼&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;坐标值为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;	[[   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [  &lt;span class=&quot;number&quot;&gt;52.&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;81.&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;107.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;[Finished &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0.4&lt;/span&gt;s]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;numpy的操作&quot;&gt;&lt;a href=&quot;#numpy的操作&quot; class=&quot;headerlink&quot; title=&quot;numpy的操作&quot;&gt;&lt;/a&gt;numpy的操作&lt;/h2&gt;&lt;p&gt; numpy是python的一个数据操作库，可以像matlab一样操作数组跟矩阵。&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;find_max_numpy&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(center)&lt;/span&gt;:&lt;/span&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	print(&lt;span class=&quot;string&quot;&gt;&quot;中心点坐标为&quot;&lt;/span&gt;)	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	m,n = np.shape(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	center_res = center[:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]-(center[:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]+center[:,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;])/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; (&lt;span class=&quot;string&quot;&gt;&quot;结果为[&amp;#123;&amp;#125;]&quot;&lt;/span&gt;.format(center_res))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	imax = center_res.max() &lt;span class=&quot;comment&quot;&gt;#找到最大值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	idmax = np.where(center_res == imax) &lt;span class=&quot;comment&quot;&gt;#得到最大值的索引位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	idmax = np.int32(idmax) &lt;span class=&quot;comment&quot;&gt;#由于它得到的是一个索引位置，所以需要转化成int类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	zero = np.zeros([m,n])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	zero[idmax] = center[idmax]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	print(&lt;span class=&quot;string&quot;&gt;&quot;选取第[&amp;#123;&amp;#125;]类&quot;&lt;/span&gt;.format(idmax + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	print(&lt;span class=&quot;string&quot;&gt;&quot;坐标值为&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	print(zero)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;结果&quot;&gt;&lt;a href=&quot;#结果&quot; class=&quot;headerlink&quot; title=&quot;结果&quot;&gt;&lt;/a&gt;结果&lt;/h2&gt; &lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cen = np.float32(np.array([[&lt;span class=&quot;number&quot;&gt;137&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;81&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;127&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;]]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;find_max_numpy(cen)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt; 中心点坐标为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;	[[&lt;span class=&quot;number&quot;&gt;137&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [ &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [ &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;81&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;127&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;结果为 [ &lt;span class=&quot;number&quot;&gt;-6.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;2.5&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;40.5&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;-2.&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;选取第[[[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]]]类&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;坐标值为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;	[[   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [  &lt;span class=&quot;number&quot;&gt;52.&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;81.&lt;/span&gt;  &lt;span class=&quot;number&quot;&gt;107.&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	 [   &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;    &lt;span class=&quot;number&quot;&gt;0.&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;[Finished &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt;s]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;运行速度&quot;&gt;&lt;a href=&quot;#运行速度&quot; class=&quot;headerlink&quot; title=&quot;运行速度&quot;&gt;&lt;/a&gt;运行速度&lt;/h2&gt;&lt;p&gt; &lt;strong&gt;可以算2个function的复杂度，第一个为O(n^2）,第二个矩阵操作应该快得多。从时间上来说也很明显，第一个0.4秒，第二个0.1秒 &lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Python-操作numpy-矩阵代替for循环&quot;&gt;&lt;a href=&quot;#Python-操作numpy-矩阵代替for循环&quot; class=&quot;headerlink&quot; title=&quot;Python 操作numpy 矩阵代替for循环&quot;&gt;&lt;/a&gt;Python 操作numpy 矩阵代替for循环&lt;/h1&gt;&lt;h2 id=&quot;具体问题：&quot;&gt;&lt;a href=&quot;#具体问题：&quot; class=&quot;headerlink&quot; title=&quot;具体问题：&quot;&gt;&lt;/a&gt;具体问题：&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;上一篇文章中，使用kmeans聚类后，我得到了一个存放4个中心点颜色值的4 &lt;em&gt; 3矩阵。为了得到这个矩阵中，颜色残差最大的那个分类的索引，我必须使第三列减去（第一+第二列）的均值。最后找出色差最大的值，并返回索引。&lt;br&gt;** 4 &lt;/em&gt; 3矩阵中，使用for循环好像没什么问题，但是如果这个矩阵是1000乘以1000呢？那么循环次数达到了惊人的10^6次。**&lt;br&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://weather319.github.io/tags/python/"/>
    
      <category term="numpy" scheme="http://weather319.github.io/tags/numpy/"/>
    
  </entry>
  
  <entry>
    <title>Python 使用kmeans聚类分割目标</title>
    <link href="http://weather319.github.io/2016/04/28/Python-%E4%BD%BF%E7%94%A8kmeans%E8%81%9A%E7%B1%BB%E5%88%86%E5%89%B2%E7%9B%AE%E6%A0%87/"/>
    <id>http://weather319.github.io/2016/04/28/Python-使用kmeans聚类分割目标/</id>
    <published>2016-04-28T11:53:54.000Z</published>
    <updated>2016-04-29T07:18:59.000Z</updated>
    
    <content type="html">&lt;h1 id=&quot;Python-使用kmeans聚类分割目标&quot;&gt;&lt;a href=&quot;#Python-使用kmeans聚类分割目标&quot; class=&quot;headerlink&quot; title=&quot;Python 使用kmeans聚类分割目标&quot;&gt;&lt;/a&gt;Python 使用kmeans聚类分割目标&lt;/h1&gt;&lt;h3 id=&quot;关于背景&quot;&gt;&lt;a href=&quot;#关于背景&quot; class=&quot;headerlink&quot; title=&quot;关于背景&quot;&gt;&lt;/a&gt;关于背景&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;在复杂变化的背景中，识别运动目标并跟踪是一件很困难的事情。简单使用灰度阈值或HSV颜色空间阈值分割在特定环境下效果不错，但是在现实环境下（水草、淤泥变化）导致阈值的选择会非常不容易。&lt;/li&gt;
&lt;li&gt;当对象受到光影变化或者背景颜色从黑转化到白等，都会导致目标残缺。&lt;/li&gt;
&lt;li&gt;最重要的问题在于，由于使用阈值分割，不但需要手动设定阈值，不同的背景阈值差别很大，效率非常低。&lt;/li&gt;
&lt;li&gt;生成的轮廓数量会大于目标轮廓数量，需要条件检索目标轮廓，在特定情况下时，会导致目标丢失。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不像汽车、人脸等跟踪，因为鱼没有特定的特征，又需要精确获取目标轮廓来计算速度、尾频等参数，目前大部分办法都是使用离线的模式：即录像、分析、分割目标、计算参数。&lt;/strong&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;在视频的实时跟踪中，直接对rgb图像进行聚类，比如设定类数为4-5类，这样可以使复杂背景在光影下寻找目标变简单快速。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;代码演示&quot;&gt;&lt;a href=&quot;#代码演示&quot; class=&quot;headerlink&quot; title=&quot;代码演示&quot;&gt;&lt;/a&gt;代码演示&lt;/h2&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;find_fish_kmeans&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(image)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kernel = np.ones((&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;), np.uint8)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    img = image.copy()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; image &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        print(&lt;span class=&quot;string&quot;&gt;&quot;图像加载错误&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        sys.exit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; len(np.shape(image)) != &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;不是多通道图片，请确认图像类型&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sys.exit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            m, n, _ = np.shape(img)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# kmeans聚类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Z = np.float32(img.reshape((&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)))  &lt;span class=&quot;comment&quot;&gt;# 把图像拉伸成一列&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;Z的尺寸为[&amp;#123;&amp;#125;]&quot;&lt;/span&gt;.format(np.shape(Z)))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            criteria = (cv2.TERM_CRITERIA_EPS +&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        cv2.TERM_CRITERIA_MAX_ITER, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            K = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ret, label, center = cv2.kmeans(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Z, K, &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;, criteria, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, cv2.KMEANS_RANDOM_CENTERS)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            center = np.uint8(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;中心点坐标为&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;label的尺寸为[&amp;#123;&amp;#125;]&quot;&lt;/span&gt;.format(np.shape(label.flatten())))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            img1 = center[label.flatten()]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            img1_kmeans = img1.reshape((img.shape))  &lt;span class=&quot;comment&quot;&gt;# 获得聚类的图像&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			center_zero = np.float32(center)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            red_max = (center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                            [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; red_max&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            idmax = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, K):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                print(center_zero[i][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                           [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (center_zero[i][&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;) &amp;gt; red_max:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    red_max = (center_zero[i][&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                               &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] - (center_zero[i][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] + center_zero[i][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]) / &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;comment&quot;&gt;# print red_max&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    idmax = i&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            zero = np.zeros(np.shape(center))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            zero[idmax] = center[idmax]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;comment&quot;&gt;# zero = np.uint8(zero) #如果不转化回uint8，图像显示为黑白色。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;选取第[&amp;#123;&amp;#125;]类为鱼&quot;&lt;/span&gt;.format(idmax + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(&lt;span class=&quot;string&quot;&gt;&quot;坐标值为&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(zero)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            img2 = zero[label.flatten()]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            img2_kmeans = img2.reshape((img.shape))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; img1_kmeans, img2_kmeans, center, label&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;结果：&quot;&gt;&lt;a href=&quot;#结果：&quot; class=&quot;headerlink&quot; title=&quot;结果：&quot;&gt;&lt;/a&gt;结果：&lt;/h2&gt;&lt;p&gt;鱼-光影下  &lt;img src=&quot;http://7xti8v.com1.z0.glb.clouddn.com/fishresult_1.png&quot; alt=&quot;鱼-光影下&quot;&gt;&lt;br&gt;鱼-阴影下  &lt;img src=&quot;http://7xti8v.com1.z0.glb.clouddn.com/fishresult_2.png&quot; alt=&quot;鱼-阴影下&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;优点：&quot;&gt;&lt;a href=&quot;#优点：&quot; class=&quot;headerlink&quot; title=&quot;优点：&quot;&gt;&lt;/a&gt;优点：&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;直接调用opencv的 cv2.kmeans函数，速度快，视频的实时跟踪不容易丢失轮廓，对鱼的速度、尾频计算非常有用。&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;另一大难点在于，2个目标A与B重合时识别到各自的轮廓，AB分离后，继续跟踪到对应的目标AB而不是BA&quot;&gt;&lt;a href=&quot;#另一大难点在于，2个目标A与B重合时识别到各自的轮廓，AB分离后，继续跟踪到对应的目标AB而不是BA&quot; class=&quot;headerlink&quot; title=&quot;另一大难点在于，2个目标A与B重合时识别到各自的轮廓，AB分离后，继续跟踪到对应的目标AB而不是BA&quot;&gt;&lt;/a&gt;&lt;em&gt;另一大难点在于，2个目标A与B重合时识别到各自的轮廓，AB分离后，继续跟踪到对应的目标AB而不是BA&lt;/em&gt;&lt;/h3&gt;</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Python-使用kmeans聚类分割目标&quot;&gt;&lt;a href=&quot;#Python-使用kmeans聚类分割目标&quot; class=&quot;headerlink&quot; title=&quot;Python 使用kmeans聚类分割目标&quot;&gt;&lt;/a&gt;Python 使用kmeans聚类分割目标&lt;/h1&gt;&lt;h3 id=&quot;关于背景&quot;&gt;&lt;a href=&quot;#关于背景&quot; class=&quot;headerlink&quot; title=&quot;关于背景&quot;&gt;&lt;/a&gt;关于背景&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;在复杂变化的背景中，识别运动目标并跟踪是一件很困难的事情。简单使用灰度阈值或HSV颜色空间阈值分割在特定环境下效果不错，但是在现实环境下（水草、淤泥变化）导致阈值的选择会非常不容易。&lt;/li&gt;
&lt;li&gt;当对象受到光影变化或者背景颜色从黑转化到白等，都会导致目标残缺。&lt;/li&gt;
&lt;li&gt;最重要的问题在于，由于使用阈值分割，不但需要手动设定阈值，不同的背景阈值差别很大，效率非常低。&lt;/li&gt;
&lt;li&gt;生成的轮廓数量会大于目标轮廓数量，需要条件检索目标轮廓，在特定情况下时，会导致目标丢失。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;不像汽车、人脸等跟踪，因为鱼没有特定的特征，又需要精确获取目标轮廓来计算速度、尾频等参数，目前大部分办法都是使用离线的模式：即录像、分析、分割目标、计算参数。&lt;/strong&gt;
    
    </summary>
    
    
      <category term="python" scheme="http://weather319.github.io/tags/python/"/>
    
      <category term="opencv" scheme="http://weather319.github.io/tags/opencv/"/>
    
  </entry>
  
</feed>
